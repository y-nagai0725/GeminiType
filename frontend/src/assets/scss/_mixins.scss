@use "./_variables.scss" as *;
@use "sass:math";
@use "sass:meta";

// ==========================================
//  1. 数値から単位を取り除く関数
// ==========================================
@function strip-unit($number) {
  @if meta.type-of($number) == "number" and not math.is-unitless($number) {
    @return math.div($number, ($number * 0 + 1));
  }
  @return $number;
}

// ==========================================
//  2. pxをremに変換する関数
//     html { font-size: 62.5%; } 前提なので、10で割る
// ==========================================
@function px-to-rem($px) {
  $val: strip-unit($px);
  @return math.div($val, 10) * 1rem;
}

// ==========================================
//  3. clamp() をremで自動生成するmixin
// ==========================================
@mixin fluid-text($min-font-size, $max-font-size, $min-viewport: 375, $max-viewport: 1200) {
  // 単位除去
  $min-size: strip-unit($min-font-size);
  $max-size: strip-unit($max-font-size);
  $min-vw: strip-unit($min-viewport);
  $max-vw: strip-unit($max-viewport);

  // 傾き計算
  $size-diff: $max-size - $min-size;
  $vw-diff: $max-vw - $min-vw;

  $slope: math.div($size-diff, $vw-diff);
  $y-intercept: $min-size - ($slope * $min-vw);

  // 出力
  font-size: clamp(
    #{px-to-rem($min-size)},
    calc(#{px-to-rem($y-intercept)} + #{$slope * 100}vw),
    #{px-to-rem($max-size)}
  );
}

// ==========================================
//  4. 汎用版：プロパティを指定して可変にするMixin
//     使い方: @include fluid-style(padding-bottom, 20, 60);
// ==========================================
@mixin fluid-style($property, $min-value, $max-value, $min-vw: 375, $max-vw: 1200) {
  // 単位除去
  $min-val: strip-unit($min-value);
  $max-val: strip-unit($max-value);
  $min-vw: strip-unit($min-vw);
  $max-vw: strip-unit($max-vw);

  // 傾き計算
  $val-diff: $max-val - $min-val;
  $vw-diff: $max-vw - $min-vw;

  $slope: math.div($val-diff, $vw-diff);
  $y-intercept: $min-val - ($slope * $min-vw);

  // 指定されたプロパティに対して出力
  #{$property}: clamp(
    #{px-to-rem($min-val)},
    calc(#{px-to-rem($y-intercept)} + #{$slope * 100}vw),
    #{px-to-rem($max-val)}
  );
}

//タブレット用メディアクエリ
@mixin tab {
  @media screen and (min-width: 768px) {
    @content;
  }
}

//PC用メディアクエリ
@mixin pc {
  @media screen and (min-width: 1024px) {
    @content;
  }
}

//pc用hover
@mixin hover {
  @media (any-hover: hover) {
    &:hover {
      @content;
    }
  }
}

//コンテンツ幅
@mixin contents-width {
  padding: 0 2rem;

  @include tab {
    padding: 0 3rem;
  }

  @include pc {
    padding: 0;
    margin-inline: auto;
    width: 90%;
    max-width: 1200px;
  }
}
